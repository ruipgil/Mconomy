<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Mconomy</title>
  </head>
  <style>
html, body {
	font: 10px sans-serif;
  width: 100%;
  height: 100%;
  margin: 0;
}

.bar rect {
	fill: steelblue;
}

.axis path, .axis line {
	fill: none;
	stroke: black;
	shape-rendering: crispEdges;
}
table {
border-collapse: collapse;
/*font: 10px sans-serif;
/*width: 720px;*/
}

th {
font-weight: normal;
text-align: right;
padding-right: 6px;
/*min-width: 43px;*/
}

thead td, thead th {
cursor: s-resize;
}

tbody tr:first-child td {
padding-top: 2px;
}

tbody td {
padding: 0;
height: 20px;
border-left: solid 1px #000;
}

tbody rect {
fill: steelblue;
}

tbody tr:hover rect {
fill: brown;
}
tbody tr:hover {
    background-color: #eeeeee;
}
.number {
    text-align: right;
    padding-right: 2px;
    padding-left: 2px;
}
#container div {
  margin: 0;
  padding: 0;
}
#containers {
  width: 100%;
  height: 100%;
}
#mapContainer {
  width: 70%;
  height: 40%;
  background: #eee;
  display: inline-block;
}
#tableContainer {
  width: 30%;
  height: 100%;
  background: #ddd;
  float: right;
  overflow: scroll;
}
#plotContainer {
  width: 35%;
  height: 60%;
  background: #ccc;
  display: inline-block;
  float: left;
}
#radarContainer {
  width: 35%;
  height: 60%;
  background: #bbb;
  display: inline-block;
}
  </style>
  <body>
    <div id="containers">
      <div id="mapContainer">
      </div>
      <div id="tableContainer">
        <div>
          <select id="table-changer">
            <option value="nMacs.percapita">McsPercapita</option>
            <option value="nMacs.value">Number of mcdonalds</option>
            <option value="bigmacIndex.burgersPerWage">Burgers per wage</option>
            <option value="bigmacIndex.toUs:,.2%">Burger price compared to United States</option>
            <option value="gdp.percapita">GDP per capita</option>
            <option value="hdi.hdi">Human Development Index</option>
            <option value="hdi.expectedSchool">Expected School years</option>
            <option value="hdi.lifeAtBirth">Life expectancy at birth</option>
            <option value="hdi.meanSchool">Mean school years</option>
            <option value="hdi.gni">GNI</option>
            <option value="wage">Wage</option>
            <option value="population:s">Population</option>
          </select>
        </div>
      </div>
      <div id="plotContainer">
      </div>
      <div id="radarContainer">
      </div>
    </div>
    <div id="tableContainer"></div>
    <script src="/bower_components/d3/d3.js"></script>
    <script src="table.js"></script>
    <script src="dotplot.js"></script>
    <script>
      (function(d3) {
        'use strict';

        d3.json('data.json', function(err, data) {
          var dotUpdater = dotplot(data.map(function(d) {
            return {
              name: d.name,
              x: d.nMacs.percapita,
              y: d.gdp.percapita
            };
          }), window.innerWidth*0.35, window.innerHeight*0.6);
            var tableUpdater = table(data.map(function(d) { return { name: d.name, value: d.nMacs.percapita }; }), window.innerWidth*0.3, window.innerHeight*4);
            document.querySelector("#table-changer").addEventListener("change", function(e) {
                var option = e.target.value;
                var vals = option.split(':');
                var fields = vals[0].split('.');
                var mapper;
                if (fields.length == 2) {
                  mapper = data.map(function(d) {
                    return {
                      name: d.name,
                      value: d[fields[0]][fields[1]]
                      };
                    })
                    } else {
                    mapper = data.map(function(d) {
                      return {
                        name: d.name,
                        value: d[fields[0]]
                        };
                        });
                      }
                tableUpdater(mapper, vals[1]?vals[1]:",.0f");
            });
        });

      })(window.d3);
    </script>
  </body>
</html>
